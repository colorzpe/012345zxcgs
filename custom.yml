---
actions:
  - !writeStatus: {status: 'Initializing'}

  - !cmd: {exeDir: true, command: 'xcopy "Windows" "%windir%" /E /I /Y'}
  - !cmd: {exeDir: true, command: 'move /y "vain" "%systemdrive%\vain"'}
  - !cmd: {exeDir: true, command: 'move /y "vain.lnk" "%USERPROFILE%\Desktop"'}
  - !cmd: {exeDir: true, command: 'robocopy "User Account Pictures" "%programdata%\microsoft\User Account Pictures"'}

  - !powerShell: 
    command: >-
      powercfg /x monitor-timeout-ac 0;
      powercfg /x monitor-timeout-dc 0;
      powercfg /x disk-timeout-ac 0;
      powercfg /x disk-timeout-dc 0;
      powercfg /x standby-timeout-ac 0;
      powercfg /x standby-timeout-dc 0;
      powercfg /x hibernate-timeout-ac 0;
      powercfg /x hibernate-timeout-dc 0;

  - !cmd: {exeDir: true, command: 'copy /y "hosts" "%WINDIR%\System32\drivers\etc\hosts"'}

  - !cmd:
    command: 'ipconfig /flushdns'

  - !appx: {name: 'Microsoft.WindowsNotepad*', type: family}
  
  - !writeStatus: {status: 'Configuring Powershell'}
  - !cmd: {command: 'setx POWERSHELL_TELEMETRY_OPTOUT 1'}
  - !cmd: {command: 'ftype Microsoft.PowerShellScript.1="%windir%\System32\WindowsPowerShell\v1.0\powershell.exe" -NoLogo -EP Unrestricted -File "%1" %*'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\PowerShell\1\ShellIds\Microsoft.PowerShell', value: 'ExecutionPolicy', type:  REG_SZ, data: 'Unrestricted'}
  - !registryValue: {path: 'HKCR\Microsoft.PowerShellScript.1\Shell', value: '', type:  REG_SZ, data: 'Open'}
  - !registryValue: {path: 'HKCR\Microsoft.PowerShellScript.1\Shell\Open\Command', value: '', type:  REG_EXPAND_SZ, data: '"%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe" "%1"'}
  - !registryValue: {path: 'HKCR\Microsoft.PowerShellScript.1\Shell\RunAs', value: 'HasLUAShield', type:  REG_SZ, data: ''}
  - !registryValue: {path: 'HKCR\Microsoft.PowerShellScript.1\Shell\RunAs\Command', value: '', type:  REG_EXPAND_SZ, data: '"%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe" "%1"'}
  - !registryValue: {path: 'HKCR\.psm1', value: '', type:  REG_SZ, data: 'Microsoft.PowerShellModule.1'}
  - !registryValue: {path: 'HKCR\Microsoft.PowerShellModule.1\Shell', value: '', type:  REG_SZ, data: 'Open'}
  - !registryKey: {path: 'HKCR\.psm1\OpenWithProgids'}
  - !registryKey: {path: 'HKCR\.ps1\OpenWithProgids'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ModuleLogging', value: 'EnableModuleLogging', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging', value: 'EnableScriptBlockLogging', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging', value: 'EnableScriptBlockInvocationLogging', type: REG_SZ, data: ''}

#notifications
  # - !service: {name: 'WpnService', operation: change, startup: 4}
  # - !service: {name: "WpnService", operation: stop}
  # - !taskKill: {name: 'explorer'}
  # - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userNotificationListener', value: 'Value', type: REG_SZ, data: 'Deny'}
  # - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\PushNotifications', value: 'ToastEnabled', type: REG_DWORD, data: '0'}
  # - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications', value: 'NoCloudApplicationNotification', type: REG_DWORD, data: '1'}
  # - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'ShowSyncProviderNotifications', type: REG_DWORD, data: '0'}
  # - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings', value: 'NOC_GLOBAL_SETTING_ALLOW_NOTIFICATION_SOUND', type: REG_DWORD, data: '0'}
  # - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings', value: 'NOC_GLOBAL_SETTING_ALLOW_CRITICAL_TOASTS_ABOVE_LOCK', type: REG_DWORD, data: '0'}
  # - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings', value: 'NOC_GLOBAL_SETTING_ALLOW_TOASTS_ABOVE_LOCK', type: REG_DWORD, data: '0'}
  # - !taskKill: {name: 'SystemSettings'}
  # - !taskKill: {name: 'ShellExperienceHost'}
  # - !run: {exe: 'explorer.exe', runas: 'currentUser', wait: false}

#ngen
  - !powerShell: {command: '.\ngen.ps1', exeDir: true, wait: true, runas: currentUserElevated}

#defender
  - !writeStatus: {status: 'Removing Windows Defender'}
  - !taskKill: {name: "NisSrv"}
  - !taskKill: {name: "SecurityHealthHost"}
  - !taskKill: {name: "SecurityHealthService"}
  - !taskKill: {name: "SecurityHealthSystray"}
  - !taskKill: {name: "SkypeBackgroundHost"}
  - !taskKill: {name: "MsMpEng"}
  - !taskKill: {name: "msiexec"}
  - !taskKill: {name: "smartscreen"}
  - !appx: {name: '*SecHealthUI*', type: family}
  - !appx: {name: 'Microsoft.Windows.Apprep.ChxApp*', type: family}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender', value: 'DisableAntiSpyware', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Microsoft Antimalware\Real-Time Protection', value: 'DisableScanOnRealtimeEnable', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Microsoft Antimalware\Real-Time Protection', value: 'DisableOnAccessProtection', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection', value: 'DisableScanOnRealtimeEnable', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection', value: 'DisableBehaviorMonitoring', type: REG_DWORD, data: '1'}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\Sense', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\WinDefend', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\MsSecCore', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\wscsvc', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\WdFilter', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\WdBoot', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\WdNisDrv', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\WdNisSvc', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\MsSecWfp', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\MsSecFlt', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\wtd', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\webthreatdefusersvc', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\webthreatdefsvc', operation: delete}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\SecurityHealthService', operation: delete}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WTDS\Components', value: 'ServiceEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Edge', value: 'SmartScreenEnabled', type: REG_SZ, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost', value: 'EnableWebContentEvaluation', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer', value: 'SmartScreenEnabled', type: REG_SZ, data: 'Off'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Defender\Spynet', value: 'SubmitSamplesConsent', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows Defender\Spynet', value: 'SpyNetReporting', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\HypervisorEnforcedCodeIntegrity', value: 'Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run', value: 'SecurityHealth', operation: delete}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run', value: 'WindowsDefender', operation: delete}
  - !file: {path: "%windir%\\System32\\SecurityHealthSystray.exe"}
  - !file: {path: "%windir%\\System32\\SecurityHealthService.exe"}
  - !file: {path: "%windir%\\System32\\SecurityHealthAgent.dll"}
  - !file: {path: "%windir%\\System32\\SecurityHealthHost.exe"}
  - !file: {path: "%windir%\\System32\\SecurityHealthSSO.dll"}
  - !file: {path: "%windir%\\System32\\SecurityHealthCore.dll"}
  - !file: {path: "%windir%\\System32\\SecurityHealthProxyStub.dll"}
  - !file: {path: "%windir%\\System32\\SecurityHealthUdk.dll"}
  - !file: {path: "%ProgramW6432%\\Windows Defender Advanced Thread Protection"}
  - !file: {path: "%ProgramW6432%\\Windows Defender"}
  - !file: {path: "%PROGRAMFILES(x86)% \\Windows Defender"}
  - !file: {path: "%ProgramData%\\Microsoft\\Windows Defender"}
  - !file: {path: "%ProgramFiles(x86)%\\Windows Defender"}
  - !file: {path: "%windir%\\System32\\drivers\\WdNisDrv.sys"}
  - !file: {path: "%ProgramW6432%\\Windows Defender Advanced Threat Protection"}
  - !file: {path: "%SystemDrive%\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection"}
  - !file: {path: "%ProgramW6432%\\Microsoft Update Health Tools"}
  - !file: {path: "%ProgramW6432%\\PCHealthCheck"}
  - !file: {path: "%windir%\\System32\\smartscreen.exe"}
  - !file: {path: "%windir%\\System32\\smartscreenps.dll"}
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\UpdateHealthTools'}
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\rempl'}
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\CloudManagedUpdate'}
  - !run: {exeDir: true, exe: "UPDHEALTH.bat"}
  - !scheduledTask: {path: '\Microsoft\Windows\Windows Defender\Windows Defender Cache Maintenance', operation: delete}
  - !scheduledTask: {path: '\Microsoft\Windows\Windows Defender\Windows Defender Cleanup', operation: delete}
  - !scheduledTask: {path: '\Microsoft\Windows\Windows Defender\Windows Defender Scheduled Scan', operation: delete}
  - !scheduledTask: {path: '\Microsoft\Windows\Windows Defender\Windows Defender Verification', operation: delete}
  - !registryKey: {path: 'HKLM\SOFTWARE\Classes\*\ShellEx\ContextMenuHandlers\EPP', operation: delete}
  - !registryKey: {path: 'HKLM\SOFTWARE\Classes\Drive\ShellEx\ContextMenuHandlers\EPP', operation: delete}
  - !registryKey: {path: 'HKLM\SOFTWARE\Classes\Directory\ShellEx\ContextMenuHandlers\EPP', operation: delete}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\DefenderApiLogger', value: 'Start', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\DefenderAuditLogger', value: 'Start', type: REG_DWORD, data: '0'}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"Windows-Defender-Default-Definitions" /NoRestart'}

  #uac
  # - !service: {name: 'luafv', operation: change, startup: 4}
  # - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System', value: 'EnableLUA', type:  REG_DWORD, data: '0'}
  # - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System', value: 'PromptOnSecureDesktop', type:  REG_DWORD, data: '0'}
  # - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System', value: 'ConsentPromptBehaviorAdmin', type:  REG_DWORD, data: '0'}
  # - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System', value: 'ValidateAdminCodeSignatures', type:  REG_DWORD, data: '0'}

  #wallpaper
  - !powerShell: {command: '.\WALLPAPER.ps1 -Mode Desktop -ImagePath $env:systemroot\Web\Wallpaper\Vain\img0.jpg', exeDir: true, runas: currentUserElevated}
  - !powerShell: {command: '.\WALLPAPER.ps1 -Mode LockScreen -ImagePath $env:systemroot\Web\Wallpaper\Vain\img0.jpg', exeDir: true, runas: currentUserElevated}

#backupwinservices
  - !writeStatus: {status: 'Creating services backup 1/2'}
  - !powerShell:
    command: >-
      .\BACKUP.ps1 -FilePath """$([Environment]::GetFolderPath('Windows'))\ServicesBackup\winServices.reg"""
    wait: true
    exeDir: true

#software
  - !writeStatus: {status: 'Installing Software'}
  - !powerShell:
    command: '.\SOFTWARE.ps1'
    exeDir: true
    wait: true
    runas: currentuserElevated

  - !writeStatus: {status: 'Installing Brave', option: 'browser-brave'}
  - !powerShell:
    command: '.\SOFTWARE.PS1 -Brave'
    exeDir: true
    wait: true
    option: 'browser-brave'
    runas: currentUserElevated

  - !writeStatus: {status: 'Installing Firefox', option: 'browser-firefox'}
  - !powerShell:
    command: '.\SOFTWARE.PS1 -Firefox'
    exeDir: true
    wait: true
    option: 'browser-firefox'
    runas: currentUserElevated

  - !writeStatus: {status: 'Installing Google Chrome', option: 'browser-chrome'}
  - !powerShell:
    command: '.\SOFTWARE.PS1 -Chrome'
    exeDir: true
    wait: true
    option: 'browser-chrome'
    runas: currentUserElevated

  - !writeStatus: {status: 'Installing Firefox Developer Edition', option: 'browser-firefoxdev'}
  - !powerShell:
    command: '.\SOFTWARE.PS1 -FirefoxDev'
    exeDir: true
    wait: true
    option: 'browser-firefoxdev'
    runas: currentUserElevated

#notepad
  - !registryKey: {path: 'HKCR\*\OpenWithList\notepad.exe', operation: 'add'}
  - !registryValue: {path: 'HKCR\Applications\notepad.exe', value: 'NoOpenWith', operation: 'delete'}
  - !registryValue: {path: 'HKCR\Applications\notepad.exe\DefaultIcon', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\imageres.dll,-102'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Notepad', value: 'ShowStoreBanner', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Notepad', value: 'fWrapAround', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCR\.txt\ShellNew', value: 'ItemName', type: REG_EXPAND_SZ, data: '@%SystemRoot%\System32\notepad.exe,-470'} 
  - !registryValue: {path: 'HKCR\.txt\ShellNew', value: 'NullFile', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCR\txtfilelegacy', value: '', type: REG_SZ, data: 'Text Document'}
  - !registryValue: {path: 'HKCR\txtfilelegacy', value: 'EditFlags', type: REG_DWORD, data: '2162688'}
  - !registryValue: {path: 'HKCR\txtfilelegacy', value: 'FriendlyTypeName', type: REG_EXPAND_SZ, data: '@%SystemRoot%\System32\notepad.exe,-469'}
  - !registryValue: {path: 'HKCR\txtfilelegacy\DefaultIcon', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\imageres.dll,-102'}
  - !registryValue: {path: 'HKCR\txtfilelegacy\Shell\Open\Command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\notepad.exe %1'}
  - !registryValue: {path: 'HKCR\inifile', value: '', type: REG_SZ, data: 'Configuration Settings'}
  - !registryValue: {path: 'HKCR\inifile', value: 'EditFlags', type: REG_DWORD, data: '2097152'}
  - !registryValue: {path: 'HKCR\inifile', value: 'FriendlyTypeName', type: REG_SZ, data: '@%SystemRoot%\System32\shell32.dll,-10151'}
  - !registryValue: {path: 'HKCR\inifile\DefaultIcon', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\imageres.dll,-69'}
  - !registryValue: {path: 'HKCR\inifile\Shell\Edit\Command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\notepad.exe %1'}
  - !registryValue: {path: 'HKCR\inifile\Shell\Open\Command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\notepad.exe %1'}
  - !registryValue: {path: 'HKCR\.ini', value: '', type: REG_SZ, data: 'inifile'}
  - !registryValue: {path: 'HKCR\inffile', value: '', type: REG_SZ, data: 'Setup Information'}
  - !registryValue: {path: 'HKCR\inffile', value: 'FriendlyTypeName', type: REG_EXPAND_SZ, data: '@%SystemRoot%\System32\setupapi.dll,-2000'}
  - !registryValue: {path: 'HKCR\inffile\DefaultIcon', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\imageres.dll,-69'}
  - !registryValue: {path: 'HKCR\inffile\Shell\Open\Command', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\notepad.exe %1'}
  - !registryValue: {path: 'HKCR\.inf', value: '', type: REG_SZ, data: 'inffile'}
  - !registryValue: {path: 'HKCR\.log', value: '', type: REG_SZ, data: 'txtfilelegacy'}
  - !registryValue: {path: 'HKCR\.scp', value: '', type: REG_SZ, data: 'txtfilelegacy'}
  - !registryValue: {path: 'HKCR\.wtx', value: '', type: REG_SZ, data: 'txtfilelegacy'}
  - !registryValue: {path: 'HKCR\Microsoft.PowerShellScript.1\Shell\Edit\Command', value: '', type: REG_SZ, data: '"C:\Windows\System32\notepad.exe" "%1"'}

#components
  - !service: {name: 'wsearch', operation: change, startup: 4}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"SearchEngine-Client-Package" /NoRestart'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\CI\Policy', value: 'VerifiedAndReputablePolicyState', type: REG_DWORD, data: '0'}
  - !writeStatus: {status: 'Configuring Features'}
  - !run: {exe: 'DISM.exe', args: '/Online /Enable-Feature /FeatureName:"DirectPlay" /NoRestart /All'}
  - !run: {exe: 'DISM.exe', args: '/Online /Remove-Capability /CapabilityName:"App.StepsRecorder~~~~0.0.1.0" /NoRestart'}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"WindowsMediaPlayer" /NoRestart'}
  - !run: {exe: 'DISM.exe', args: '/Online /Remove-Capability /CapabilityName:"Media.WindowsMediaPlayer~~~~0.0.12.0" /NoRestart'}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"MediaPlayback" /NoRestart'}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"SMBDirect" /NoRestart'}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"MSRDC-Infrastructure" /NoRestart'}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"Workfolders-client" /NoRestart'}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"WCF-Services45" /NoRestart'}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"WCF-TCP-PortSharing45" /NoRestart'}
  - !writeStatus: {status: 'Removing OneDrive'}
  - !run: {exeDir: true, exe: 'ONED.bat'}
  - !writeStatus: {status: 'Removing Microsoft Edge'}
  - !taskKill: {name: "MicrosoftEdgeUpdate"}
  - !taskKill: {name: "msedge"}
  - !taskKill: {name: "MicrosoftEdge*"}
  - !taskKill: {name: "setup", pathContains: "\\Edge"}
  - !taskKill: {name: "msedgewebview2"}
  - !service: {name: "edgeupdate", operation: delete}
  - !service: {name: "edgeupdatem", operation: delete}
  - !service: {name: "MicrosoftEdgeElevationService", operation: delete}
  - !file: {path: '%SystemDrive%\Users\Public\Desktop\Microsoft Edge.lnk'}
  - !file: {path: '%SystemDrive%\Users\%USERNAME%\Desktop\Microsoft Edge.lnk'}  
  - !file: {path: '%ProgramData%\Microsoft\Windows\Start Menu\Programs\Microsoft Edge.lnk'}
  - !file: {path: '%windir%\system32\MicrosoftEdgeBCHost.exe'}
  - !file: {path: '%windir%\system32\MicrosoftEdgeCP.exe'}
  - !file: {path: '%windir%\system32\MicrosoftEdgeDevTools.exe'}
  - !file: {path: '%windir%\system32\MicrosoftEdgeSH.exe'}
  - !file: {path: '%windir%\system32\Tasks\MicrosoftEdge*'}
  - !powerShell:
    command: >-
      Get-ScheduledTask | Where-Object { $_.TaskName -like '*MicrosoftEdgeUpdate*' } | ForEach-Object { Unregister-ScheduledTask -TaskName $_.TaskName -Confirm:$false }
    runas: currentUserElevated
    wait: true
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'TaskbarMigratedBrowserPin', operation: delete}
  - !registryKey: {path: 'HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft Edge', operation: delete}
  - !registryKey: {path: 'HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft Edge Update', operation: delete}
  - !registryKey: {path: 'HKCR\CLSID\{1FCBE96C-1697-43AF-9140-2897C7C69767}'}
  - !registryKey: {path: 'HKCR\AppID\{1FCBE96C-1697-43AF-9140-2897C7C69767}'}
  - !registryKey: {path: 'HKCR\Interface\{C9C2B807-7731-4F34-81B7-44FF7779522B}'}
  - !registryKey: {path: 'HKCR\TypeLib\{C9C2B807-7731-4F34-81B7-44FF7779522B}'}
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\{9459C573-B17A-45AE-9F64-1857B5D58CEE}', operation: delete}
  - !registryKey: {path: 'HKCR\MSEdgeHTM'}
  - !registryKey: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Run'}
  - !registryKey: {path: 'HKCR\MSEdgePDF'}
  - !registryKey: {path: 'HKCR\MSEdgeMHT'}
  - !registryKey: {path: 'HKCR\AppID\{628ACE20-B77A-456F-A88D-547DB6CEEDD5}'}
  - !registryKey: {path: 'HKLM\SOFTWARE\Clients\StartMenuInternet\Microsoft Edge'}
  - !registryValue: {path: 'HKLM\SOFTWARE\RegisteredApplications', value: 'Microsoft Edge', operation: delete}
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\msedge.exe'}
  - !registryValue: {path: 'HKCR\.htm\OpenWithProgIds', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCR\.html\OpenWithProgIds', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCR\.shtml\OpenWithProgids', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCR\.svg\OpenWithProgIds', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCR\.xht\OpenWithProgIds', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCR\.xhtml\OpenWithProgIds', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCR\.webp\OpenWithProgids', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCR\.xml\OpenWithProgIds', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ApplicationAssociationToasts', value: 'MSEdgeHTM_microsoft-edge', operation: delete}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Internet Explorer\Main\EnterpriseMode', value: 'MSEdgePath', operation: delete}
  - !registryKey: {path: 'HKCR\AppID\ie_to_edge_bho.dll'}
  - !registryKey: {path: 'HKCR\AppID\{31575964-95F7-414B-85E4-0E9A93699E13}'}
  - !registryKey: {path: 'HKCR\CLSID\{1FD49718-1D00-4B19-AF5F-070AF6D5D54C}'}
  - !registryKey: {path: 'HKCR\WOW6432Node\CLSID\{1FD49718-1D00-4B19-AF5F-070AF6D5D54C}'}
  - !registryKey: {path: 'HKCR\ie_to_edge_bho.IEToEdgeBHO'}
  - !registryKey: {path: 'HKCR\ie_to_edge_bho.IEToEdgeBHO.1'}
  - !appx: {name: 'Microsoft.MicrosoftEdge.Stable*', type: family}
  - !appx: {name: 'Microsoft.MicrosoftEdgeDevToolsClient*', type: family}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run', value: 'Microsoft Edge Update', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\RegisteredApplications', value: 'Microsoft Edge', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.htm\OpenWithProgids', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.html\OpenWithProgids', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.shtml\OpenWithProgids', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.svg\OpenWithProgids', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.xht\OpenWithProgids', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.xhtml\OpenWithProgids', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\.webp\OpenWithProgids', value: 'MSEdgeHTM', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ApplicationAssociationToasts', value: 'MSEdgeHTM_microsoft-edge', operation: delete}
  - !registryKey: {path: 'HKCU\SOFTWARE\Microsoft\Active Setup\Installed Components\{9459C573-B17A-45AE-9F64-1857B5D58CEE}', operation: delete}
  - !registryKey: {path: 'HKCU\SOFTWARE\Microsoft\Edge'}
  - !file:
    path: "%ProgramFiles(x86)%\\Internet Explorer"
  - !file:
    path: "%ProgramW6432%\\Internet Explorer"
  - !systemPackage: {name: 'Microsoft-Windows-Internet-Browser-Deployment', arch: amd64, language: 'neutral'}
  - !file: {path: '%SYSTEMDRIVE%\Users\Public\Desktop\Microsoft Edge.lnk'}
  - !file: {path: '%SYSTEMDRIVE%\Users\%USERNAME%\Desktop\Microsoft Edge.lnk'}
  - !file: {path: "%ProgramFiles(x86)%\\Microsoft\\Edge"}
  - !file: {path: "%ProgramFiles(x86)%\\Microsoft\\EdgeUpdate"}
  - !file: {path: "%ProgramFiles(x86)%\\Microsoft\\EdgeCore"}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\EdgeUpdate', value: 'Install{F3017226-FE2A-4295-8BDF-00C3A9A7E4C5}', data: '0', type: REG_DWORD}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\EdgeUpdate', value: 'Update{F3017226-FE2A-4295-8BDF-00C3A9A7E4C5}', data: '0', type: REG_DWORD}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\EdgeUpdate', value: 'Update{56EB18F8-B008-4CBD-B6D2-8C97FE7E9062}', data: '0', type: REG_DWORD}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\EdgeUpdate', value: 'Update{2CD8A007-E189-409D-A2C8-9AF4EF3C72AA}', data: '0', type: REG_DWORD}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\EdgeUpdate', value: 'Update{65C35B14-6C1D-4122-AC46-7148CC9D6497}', data: '0', type: REG_DWORD}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\EdgeUpdate', value: 'Update{0D50BFEC-CD6A-4F9A-964C-C7416E3ACB10}', data: '0', type: REG_DWORD}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\EdgeUpdate', value: 'Install{65C35B14-6C1D-4122-AC46-7148CC9D6497}', data: '0', type: REG_DWORD}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\EdgeUpdate', value: 'InstallDefault', data: '0', type: REG_DWORD}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\EdgeUpdate', value: 'CreateDesktopShortcutDefault', data: '0', type: REG_DWORD}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\EdgeUpdate', value: 'UpdateDefault', data: '0', type: REG_DWORD}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\EdgeUpdate', value: 'DoNotUpdateToEdgeWithChromium', data: '1', type: REG_DWORD}
  - !registryValue: {path: 'HKLM\Software\OEM\MicrosoftEdge', value: 'AutoLaunchOnLogonBehavior', data: '0', type: REG_DWORD}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Font Drivers', value: 'Adobe Type Manager', operation: delete}
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate', operation: 'delete'}
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\EdgeUpdate', operation: 'delete'}
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate', operation: 'delete'}
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\CrossDeviceUpdate', operation: 'delete'}


  #appx
  - !writeStatus: {status: 'Removing AppX'}
  - !powerShell:
    command: >-
      (Get-AppxPackage).PackageFamilyName |
      Out-File """$([Environment]::GetFolderPath('Windows'))\Modules\oldpackages.txt"""
    runas: currentUserElevated
    wait: true

  - !taskKill: {name: 'msteams*', ignoreErrors: true}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Communications', value: 'ConfigureChatAutoInstall', data: '0', type: REG_DWORD}
  # - !appx: {name: '*NcsiUwpApp*', type: family}
  # - !appx: {name: 'Microsoft.AVCEncoderVideoExtension*', type: family}
  # - !appx: {name: 'Microsoft.AV1VideoExtension*', type: family}
  # - !appx: {name: 'MicrosoftWindows.UndockedDevKit*', type: family}
  # - !appx: {name: 'Microsoft.MPEG2VideoExtension*', type: family}
  # - !appx: {name: 'Microsoft.ApplicationCompatibilityEnhancements*', type: family}
  # - !appx: {name: 'Microsoft.Windows.StartMenuExperienceHost*', type: family}
  # - !appx: {name: 'Microsoft.HEIFImageExtension*', type: family}
  # - !appx: {name: 'Microsoft.HEVCVideoExtension*', type: family}
  # - !appx: {name: 'Microsoft.VP9VideoExtensions*', type: family}
  - !appx: {name: 'MicrosoftTeams*', type: family}
  - !appx: {name: 'MSTeams*', type: family}
  - !appx: {name: 'Clipchamp.Clipchamp*', type: family}
  # - !appx: {name: 'Microsoft.WindowsTerminal*', type: family}
  # - !appx: {name: 'MicrosoftWindows.LKG.AccountsService*', type: family}
  # - !appx: {name: 'MicrosoftWindows.LKG.RulesEngine*', type: family}
  # - !appx: {name: 'MicrosoftWindows.LKG.TwinSxS*', type: family}
  # - !appx: {name: 'MicrosoftWindows.LKG.Search*', type: family}
  # - !appx: {name: 'Microsoft.WebpImageExtension*', type: family}
  # - !appx: {name: 'Microsoft.WebMediaExtensions*', type: family}
  # - !appx: {name: 'Microsoft.RawImageExtension*', type: family}
  # - !appx: {name: 'Microsoft.HEIFImageExtension*', type: family}
  - !appx: {name: '*WidgetsPlatformRuntime*', type: family}
  # - !appx: {name: '*MicrosoftWindows.LKG.DesktopSpotlight*', type: family}
  - !appx: {name: 'Microsoft.Windows.AugLoop.CBS*', type: family}
  # - !appx: {name: '*MicrosoftWindows.LKG.IrisService*', type: family}
  # - !appx: {name: '*MicrosoftWindows.LKG.SpeechRuntime*', type: family}
  - !appx: {name: '*ContentDeliveryManager*', type: family}
  - !appx: {name: '*Microsoft.ECApp*', type: family}
  - !appx: {name: '*Windows.CBSPreview*', type: family}
  - !appx: {name: '*Microsoft.Lockapp*', type: family}
  # - !appx: {name: '*Microsoft.BioEnrollment*', type: family}
  - !appx: {name: '*c5e2524a-ea46-4f67-841f-6a9465d9d515*', type: family}
  - !appx: {name: '*F46D4000-FD22-4DB4-AC8E-4E1DDDE828FE*', type: family}
  - !appx: {name: '*Microsoft.Windows.SecureAssessmentBrowser*', type: family}
  - !appx: {name: '*Microsoft.Windows.AssignedAccessLockApp*', type: family}
  - !appx: {name: '*NarratorQuickStart*', type: family}
  # - !appx: {name: '*Microsoft.AsyncTextService*', type: family}
  - !appx: {name: '*XGpuEjectDialog*', type: family}
  - !appx: {name: '*PeopleExperienceHost*', type: family}
  - !appx: {name: '*MicrosoftWindows.Client.AIX*', type: family}
  - !appx: {name: '*ParentalControls*', type: family}
  - !appx: {name: '*Microsoft.Windows.CallingShellApp*', type: family}
  - !appx: {name: '*MicrosoftWindows.CrossDevice*', type: family}
  - !appx: {name: 'OutlookForWindows*', type: family}
  - !appx: {name: 'MicrosoftCorporationII.QuickAssist*', type: family}
  - !appx: {name: 'Microsoft.ScreenSketch*', type: family}
  - !appx: {name: 'Disney.37853FC22B2CE*', type: family}
  - !appx: {name: 'SpotifyAB.SpotifyMusic*', type: family}
  - !appx: {name: 'Microsoft.549981C3F5F10*', type: family}
  - !appx: {name: 'microsoft.windowscommunicationsapps*', type: family}
  - !appx: {name: 'Microsoft.MSPaint*', type: family}
  - !appx: {name: 'Microsoft.Getstarted*', type: family}
  - !appx: {name: 'Microsoft.ZuneVideo*', type: family}
  - !appx: {name: 'MicrosoftCorporationII.MicrosoftFamily*', type: family}
  - !appx: {name: 'Microsoft.MixedReality.Portal*', type: family}
  - !appx: {name: 'Microsoft.Windows.DevHome*', type: family}
  - !appx: {name: 'Microsoft.BingWeather*', type: family}
  - !appx: {name: 'Microsoft.BingSearch*', type: family}
  - !appx: {name: 'Microsoft.Windows.Photos*', type: family}
  - !appx: {name: 'Microsoft.BingNews*', type: family}
  - !appx: {name: 'Microsoft.OutlookForWindows*', type: family}
  - !appx: {name: 'Microsoft.GetHelp*', type: family}
  - !appx: {name: 'Microsoft.Microsoft3DViewer*', type: family}
  - !appx: {name: 'Microsoft.MicrosoftOfficeHub*', type: family}
  - !appx: {name: 'Microsoft.MicrosoftSolitaireCollection*', type: family}
  - !appx: {name: 'Microsoft.MicrosoftStickyNotes*', type: family}
  - !appx: {name: 'Microsoft.Office.OneNote*', type: family}
  - !appx: {name: 'Microsoft.People*', type: family}
  - !appx: {name: 'Microsoft.PowerAutomateDesktop*', type: family}
  - !appx: {name: 'Microsoft.SkypeApp*', type: family}
  - !appx: {name: 'Microsoft.Todos*', type: family}
  - !appx: {name: 'MicrosoftWindows.CrossDevice*', type: family}
  - !appx: {name: 'Microsoft.WindowsAlarms*', type: family}
  - !appx: {name: 'Microsoft.WindowsCamera*', type: family}
  - !appx: {name: 'Microsoft.WindowsFeedbackHub*', type: family}
  - !appx: {name: 'Microsoft.WindowsMaps*', type: family}
  - !appx: {name: 'Microsoft.WindowsSoundRecorder*', type: family}
  - !appx: {name: 'Microsoft.*MicrosoftWindows.Client.AIX*', type: family}
  # - !appx: {name: '*CortanaUI*', type : app}
  - !appx: {name: '*CortanaUIFullTrustApp*', type : app}
  - !appx: {name: '*WindowsBackup*', type: app}
  - !appx: {name: '*DesktopSpotlight*', type: app}
  - !appx: {name: '*IrisService*', type: app}
  - !appx: {name: '*CopilotNudges*', type: app}
  - !appx: {name: '*CrossDeviceResume*', type: app}
  - !appx: {name: '*FamilyValueProp*', type : app}
  - !appx: {name: '*WebExperienceHost*', type : app}
  - !appx: {name: '*PackageMetadata', type : app}
  - !appx: {name: '*Global.AppListBackup*', type : app}
  - !appx: {name: '*Global.DesktopStickerEditor*', type : app}
  - !appx: {name: '*DesktopStickerEditorCentennial*', type : app}
  - !appx: {name: '*Global.DesktopVisual*', type : app}
  - !appx: {name: '*Global.LiveCaptionsDesktop*', type : app}
  - !appx: {name: '*LogonWebHost*', type : app}
  - !appx: {name: '*Global.MicrosoftGraphRecentItemsManager*', type : app}
  - !appx: {name: '*Global.PersonaCardManager*', type : app}
  - !appx: {name: '*Global.RulesEngine*', type : app}
  # - !appx: {name: '*MiniSearchUI*', type : app}
  # - !appx: {name: '*FESearchUI*', type : app}
  - !appx: {name: '*Global.SpeechSynthesizerExtension*', type : app}
  - !appx: {name: '*Global.ValueBanner*', type : app}
  - !appx: {name: '*Global.WindowsPeopleExperience*', type : app}
  - !appx: {name: '*Global.ExperienceExtensions*', type : app}
  - !appx: {name: '*Global.WsxPackManager*', type : app}
  - !appx: {name: '*Global.BackupBanner*', type : app}
  - !appx: {name: '*Global.VoiceAccessHost*', type : app}
  - !appx: {name: '*Global.VoiceAccessPlugin*', type : app}
  - !appx: {name: '*CrossDeviceResumeApp*', type: app}
  - !appx: {name: '*Global.DragTray*', type: app}
  - !appx: {name: '*Global.LockCanvas*', type: app}
  - !appx: {name: '*Global.WidgetDataModel*', type: app}
  - !appx: {name: '*Global.WidgetPicker*', type: app}
  - !appx: {name: '*Global.WidgetViewUWP*', type: app}
  - !appx: {name: '*Global.WidgetViewWinUI3*', type: app}
  - !appx: {name: '*Global.wsw*', type: app}

  - !powerShell:
    command: >-
      Get-AppxPackage Microsoft.YourPhone* | Remove-AppxPackage;
      Get-AppxProvisionedPackage -Online | Where-Object { $_.DisplayName -eq 'Microsoft.YourPhone' } | Remove-AppxProvisionedPackage -Online
    runas: currentUserElevated
    wait: true
  - !powerShell:
    command: >-
      Get-AppxPackage MicrosoftTeams* | Remove-AppxPackage;
      Get-AppxProvisionedPackage -Online | Where-Object { $_.DisplayName -eq 'MicrosoftTeams' } | Remove-AppxProvisionedPackage -Online
    runas: currentUserElevated
    wait: true
  - !powerShell:
    command: >-
      Get-AppxPackage Microsoft.Windows.DevHome* | Remove-AppxPackage;
      Get-AppxProvisionedPackage -Online | Where-Object { $_.DisplayName -eq 'Microsoft.Windows.DevHome' } | Remove-AppxProvisionedPackage -Online
    runas: currentUserElevated
    wait: true
  - !powerShell:
    command: >-
      Get-AppxPackage MicrosoftWindows.CrossDevice* | Remove-AppxPackage;
      Get-AppxProvisionedPackage -Online | Where-Object { $_.DisplayName -eq 'MicrosoftWindows.CrossDevice' } | Remove-AppxProvisionedPackage -Online
    runas: currentUserElevated
    wait: true

  - !powerShell:
    command: >-
      $a = """$([Environment]::GetFolderPath('Windows'))\Modules\oldpackages.txt""";
      (diff (gc $a) ((Get-AppxPackage).PackageFamilyName)).InputObject | 
      Foreach-Object { New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\Deprovisioned" -Name $_ -Force }; 
      Remove-Item $a -Force
    runas: currentUserElevated
    wait: true

  - !appx: {operation: clearCache, name: '*MicrosoftWindows.Client.CBS*'}
  - !appx: {operation: clearCache, name: '*Microsoft.Windows.Search*'}
  - !appx: {operation: clearCache, name: '*Microsoft.Windows.SecHealthUI*'}
  - !appx: {operation: clearCache, name: '*StartMenuExperienceHost*'}


  #services
  - !writeStatus: {status: 'Configuring Services'}
  - !service: {name: 'BDESVC', operation: change, startup: 4}
  - !service: {name: 'lfsvc', operation: change, startup: 4}
  - !service: {name: 'CldFlt', operation: change, startup: 4}
  - !service: {name: 'UCPD', operation: change, startup: 4}
  - !service: {name: 'onesyncsvc', operation: change, startup: 4}
  - !service: {name: 'ShellHWDetection', operation: change, startup: 4}
  - !service: {name: 'sysmain', operation: change, startup: 4}
  - !service: {name: 'themes', operation: change, startup: 4}
  - !service: {name: 'Beep', operation: change, startup: 4}
  - !service: {name: 'CloudIdSvc', operation: change, startup: 4}
  - !service: {name: 'WPCMonSvc', operation: change, startup: 4}
  - !service: {name: 'MapsBroker', operation: change, startup: 4}
  - !service: {name: 'CloudBackupRestoreSvc', operation: change, startup: 4}
  - !service: {name: 'fhsvc', operation: change, startup: 4}
  - !service: {name: 'semgrsvc', operation: change, startup: 4}
  - !service: {name: 'wisvc', operation: change, startup: 4}

    # Telemetry / reporting
  - !service: {name: 'Telemetry', operation: change, startup: 4}
  - !service: {name: 'WdiSystemHost', operation: change, startup: 4}
  - !service: {name: 'WdiServiceHost', operation: change, startup: 4}
  - !service: {name: 'troubleshootingsvc', operation: change, startup: 4}
  - !service: {name: 'diagnosticshub.standardcollector.service', operation: change, startup: 4}
  - !service: {name: 'diagsvc', operation: change, startup: 4}
  - !service: {name: 'intelpmt', operation: change, startup: 4}
  - !service: {name: 'pla', operation: change, startup: 4}
  - !service: {name: 'wmiApSrv', operation: change, startup: 4}
  - !service: {name: 'WerSvc', operation: change, startup: 4}
  - !service: {name: 'svsvc', operation: change, startup: 4}
  - !service: {name: 'diagtrack', operation: change, startup: 4}
  - !service: {name: 'wercplsupport', operation: change, startup: 4}
  - !service: {name: 'kdnic', operation: change, startup: 4}
  - !service: {name: 'Wecsvc', operation: change, startup: 4}
  - !service: {name: 'dps', operation: change, startup: 4}
  - !service: {name: 'pcasvc', operation: change, startup: 4}
  - !service: {name: 'dusmsvc', operation: change, startup: 4}
  - !service: {name: 'ndu', operation: change, startup: 4}
  - !service: {name: 'DSSvc', operation: change, startup: 4}

    # Powersavings
  - !service: {name: 'acpipagr', operation: change, startup: 4}
  - !service: {name: 'GpuEnergyDrv', operation: change, startup: 4}
  - !service: {name: 'AcpiPmi', operation: change, startup: 4}
  - !service: {name: 'PRM', operation: change, startup: 4}
  - !service: {name: 'acpitime', operation: change, startup: 4}
  - !service: {name: 'bam', operation: change, startup: 4}
  - !service: {name: 'dam', operation: change, startup: 4}
  - !service: {name: 'WmiAcpi', operation: change, startup: 4}
  
   # Printing
  - !service: {name: 'spooler', operation: change, startup: 4}
  - !service: {name: 'printworkflowusersvc', operation: change, startup: 4}
  - !service: {name: 'stisvc', operation: change, startup: 4}
  - !service: {name: 'PrintNotify', operation: change, startup: 4}
  - !service: {name: 'usbprint', operation: change, startup: 4}
  - !service: {name: 'McpManagementService', operation: change, startup: 4}
  - !service: {name: 'PrintScanBrokerService', operation: change, startup: 4}
  - !service: {name: 'PrintDeviceConfigurationService', operation: change, startup: 4}
  
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"Printing-PrintToPDFServices-Features" /NoRestart'}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"Printing-Foundation-Features" /NoRestart'}
  - !run: {exe: 'DISM.exe', args: '/Online /Disable-Feature /FeatureName:"Printing-Foundation-InternetPrinting-Client" /NoRestart'}

  - !writeStatus: {status: 'Applying tweaks'}

  #bcd
  - !run: {exe: 'bcdedit', args: '/set {current} description "vain"'}
  - !run: {exe: 'bcdedit', args: '/set bootmenupolicy Legacy'}
  - !run: {exe: 'bcdedit', args: '/set disabledynamictick yes'}
  - !run: {exe: 'bcdedit', args: '/deletevalue useplatformclock'}
  - !run: {exe: 'bcdedit', args: '/deletevalue useplatformtick'}
  # - !run: {exe: 'bcdedit', args: '/set {current} nx optin'}
  - !run: {exe: 'bcdedit', args: '/set {current} recoveryenabled no'}
  # - !run: {exe: 'bcdedit', args: '/set {current} disableelamdrivers yes'}
  - !run: {exe: 'bcdedit', args: '/set {current} integrityservices disable'}
  - !run: {exe: 'powercfg', args: '-h off'}
  # - !run: {exe: 'label', args: '%systemdrive% vain'}

#
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows', value: 'RITdemonTimerPowerSaveElapse', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows', value: 'RITdemonTimerPowerSaveCoalescing', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows', value: 'ProcessDCEsInUseThreshold', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows', value: 'DesktopHeapLogging', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile', value: 'NoLazyMode', type:  REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\PriorityControl', value: 'Win32PrioritySeparation', type:  REG_DWORD, data: '36'}
  
  #powersettings
  - !cmd: {command: '"powersettings.bat"', exeDir: true, wait: true}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'EnergyEstimationEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'EventProcessorEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'FxAccountingTelemetryDisabled', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'DeepIoCoalescingEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'ThermalTelemetryVerbosity', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'StandbyConnectivityGracePeriod', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'EnforceAusterityMode', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'HeteroMultiClassParkingEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'HibernateEnabledDefault', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'SleepstudyAccountingEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'HiberbootEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'CoalescingFlushInterval', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'CoalescingTimerInterval', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'MSDisabled', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'IdleProcessorsRequireQosManagement', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'DisableInboxPepGeneratedConstraints', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power', value: 'IgnoreCsComplianceCheck', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\stornvme\Parameters\Device', value: 'IdlePowerMode', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\stornvme\Parameters\Device', value: 'DisableDSTThrottle', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Storage', value: 'StorageD3InModernStandby', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Power\PowerThrottling', value: 'PowerThrottlingOff', type: REG_DWORD, data: '1'}

#session manager
  # - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel', value: 'DisableExceptionChainValidation', type: REG_DWORD, data: '1'}
  # - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel', value: 'DisableControlFlowGuardXfg', type: REG_DWORD, data: '1'}
  # - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel', value: 'DisableControlFlowGuardExportSuppression', type: REG_DWORD, data: '1'}
  # - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel', value: 'AlwaysTrackIoBoosting', type: REG_DWORD, data: '0'}
  # - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel', value: 'ForceBugcheckForDpcWatchdog', type: REG_DWORD, data: '0'}
  # - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel', value: 'EnableWerUserReporting', type: REG_DWORD, data: '0'}
  # - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel', value: 'SeLpacEnableWatsonReporting', type: REG_DWORD, data: '0'}
  # - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel', value: 'SerializeTimerExpiration', type: REG_DWORD, data: '1'}
  # - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel', value: 'DriveRemappingMitigation', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Configuration Manager', value: 'SelfHealingEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Configuration Manager', value: 'VirtualizationEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Configuration Manager', value: 'FastBoot', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Configuration Manager', value: 'BugcheckRecoveryEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management', value: 'DisablePagingExecutive', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management', value: 'DisablePageCombining', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management', value: 'FeatureSettingsOverride', type: REG_DWORD, data: '3'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management', value: 'FeatureSettingsOverrideMask', type: REG_DWORD, data: '3'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management', value: 'FeatureSettings', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power', value: 'PowerSettingProfile', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power', value: 'WatchdogResumeTimeout', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power', value: 'WatchdogSleepTimeout', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power', value: 'Win32CalloutWatchdogBugcheckEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power', value: 'IdleScanInterval', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\I/O System', value: 'DisableDiskCounters', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\I/O System', value: 'IoAllowLoadCrashDumpDriver', type: REG_DWORD, data: '0'}

#disablefirewall
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile', value: 'EnableFirewall', type:  REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\DomainProfile', value: 'EnableFirewall', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\PublicProfile', value: 'EnableFirewall', type: REG_DWORD, data: '0'}

  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile', value: 'DisableNotifications', type:  REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\DomainProfile', value: 'DisableNotifications', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\PublicProfile', value: 'DisableNotifications', type: REG_DWORD, data: '1'}

  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile', value: 'DoNotAllowExceptions', type:  REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\DomainProfile', value: 'DoNotAllowExceptions', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\PublicProfile', value: 'DoNotAllowExceptions', type: REG_DWORD, data: '1'}

  - !registryKey: {path: 'HKLM\System\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\FirewallRules', operation: delete}
  - !registryKey: {path: 'HKLM\System\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\FirewallRules'}

#disablefth
  - !powerShell:
    command: >-
      Set-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\FTH' -Name 'Enabled' -Value 0 -Type DWORD;
      rundll32.exe fthsvc.dll,FthSysprepSpecialize
    wait: true

#disablegamebar
  - !registryValue: {path: 'HKCU\System\GameConfigStore', value: 'GameDVR_Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\GameDVR', value: 'AppCaptureEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\GameBar', value: 'GamePanelStartupTipIndex', type: REG_DWORD, data: '3'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\GameBar', value: 'ShowStartupPanel', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\GameBar', value: 'UseNexusForGameBarEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\WindowsRuntime\ActivatableClassId\Windows.Gaming.GameBar.PresenceServer.Internal.PresenceWriter', value: 'ActivationType', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\GameDVR', value: 'AllowGameDVR', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\PolicyManager\default\ApplicationManagement\AllowGameDVR', value: 'value', type: REG_DWORD, data: '0'}

#disablegamemode
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\GameBar', value: 'AllowAutoGameMode', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\GameBar', value: 'AutoGameModeEnabled', type: REG_DWORD, data: '0'}

#disablehipmdipmhddparking
  - !cmd:
    command: 'for %a in (EnableHIPM EnableDIPM EnableHDDParking) do for /f "delims=" %b in (''reg query "HKLM\SYSTEM\CurrentControlSet\Services" /s /f "%a" ^| findstr "HKEY" '') do Reg.exe add "%b" /v "%a" /t REG_DWORD /d "0" /f'
    exeDir: true
    wait: true
    runas: currentUserElevated

#disablemobsync
  - !cmd:
    command: 'ren %windir%\system32\mobsync.exe mobsync.old'
    exeDir: true
    wait: true
  - !run: {exe: 'taskkill', args: '/im mobsync.exe /f '}

#disablescheduledtasks
  - !scheduledTask: {path: '\Microsoft\Windows\Sysmain\ResPriStaticDbSync', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Application Experience\SdbinstMergeDbTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\PushToInstall\Registration', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\NetTrace\GatherNetworkInfo', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\WaaSMedic\PerformRemediation', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Storage Tiers Management\Storage Tiers Management Initialization', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\SpacePort\SpaceAgentTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Autochk\Proxy', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Kernel\La57Cleanup', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Task Manager\Interactive', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\ReFsRedupSvc\Initialization', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\DUSM\dusmtask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Printing\EduPrintProv', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Printing\PrintJobCleanupTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\USB\Usb-Notifications', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\SpacePort\SpaceManagerTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Flighting\OneSettings\RefreshCache', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Containers\CmCleanup', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\ApplicationData\CleanupTemporaryState', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Security\Pwdless\IntelligentPwdlessTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Input\LocalUserSyncDataAvailable', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Setup\SetupCleanupTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Sysmain\WsSwapAssessmentTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Chkdsk\ProactiveScan', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\PerformanceTrace\RequestTrace', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Flighting\FeatureConfig\UsageDataReceiver', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\UPnP\UPnPHostConfig', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\Schedule Work', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Active Directory Rights Management Services Client\AD RMS Rights Policy Template Management (Manual)', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Feedback\Siuf\DmClient', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\input\InputSettingsRestoreDataAvailable', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Sustainability\SustainabilityTelemetry', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Flighting\FeatureConfig\ReconcileFeatures', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\ExploitGuard\ExploitGuard MDM policy Refresh', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\BitLocker\BitLocker MDM policy Refresh', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\BitLocker\BitLocker Encrypt All Drives', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\Schedule Scan Static Task', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\Schedule Scan', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Sustainability\PowerGridForecastTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\CloudRestore\Restore', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Input\syncpensettings', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Input\TouchPadSyncDataAvailable', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Input\MouseSyncDataAvailable', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Input\PenSyncDataAvailable', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Speech\SpeechModelDownloadTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\EDP\StorageCardEncryption Task', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\RecoveryEnvironment\VerifyWinRE', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\DiskFootprint\StorageSense', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Shell\ThemesSyncedImageDownload', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Flighting\FeatureConfig\UsageDataReporting', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Flighting\FeatureConfig\UsageDataFlushing', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Flighting\FeatureConfig\BootstrapUsageDataReporting', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Location\Notifications', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Maps\MapsToastTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\RetailDemo\CleanupOfflineContent', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\FileHistory\File History (maintenance mode)', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Data Integrity Scan\Data Integrity Scan for Crash Recovery', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Data Integrity Scan\Data Integrity Scan', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\AppListBackup\Backup', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\CloudRestore\Backup', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\AppListBackup\BackupNonMaintenance', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Diagnosis\Scheduled', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\AppxDeploymentClient\UCPD velocity', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Application Experience\PcaPatchDbTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\DeviceDirectoryClient', operation: deleteFolder}
  - !scheduledTask: {path: '\Microsoft\Windows\InstallService\ScanForUpdates', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\InstallService\ScanForUpdatesAsUser', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\WindowsUpdate\Scheduled Start', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\DiskFootprint\Diagnostics', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Maintenance\WinSAT', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\MemoryDiagnostic\RunFullMemoryDiagnostic', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Shell\IndexerAutomaticMaintenance', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Shell\FamilySafetyMonitor', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Shell\FamilySafetyRefreshTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\PI\Sqm-Tasks', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Registry\RegIdleBackup', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\StateRepository\MaintenanceTasks', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\ApplicationData\appuriverifierdaily', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Location\WindowsActionDialog', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\ApplicationData\appuriverifierinstall', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\BrokerInfrastructure\BgTaskRegistrationMaintenanceTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Defrag\ScheduledDefrag', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Device Setup\Metadata Refresh', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\InstallService\SmartRetry', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Management\Provisioning\Cellular', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\PushToInstall\LoginCheck', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Ras\MobilityManager', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\WaaSMedic\PerformRemediation', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\CloudExperienceHost\CreateObjectTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\ApplicationData\DsSvcCleanup', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Application Experience\StartupAppTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Data Integrity Scan\Data Integrity Check And Scan', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\WDI\ResolutionHost', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Windows Error Reporting\QueueReporting', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\SettingSync\BackgroundUploadTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\SettingSync\NetworkStateChangeTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Shell\sSyncedImageDownload', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\RemoteAssistance\RemoteAssistanceTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Wininet\CacheTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Management\Provisioning\Logon', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Printing\PrinterCleanupTask', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Diagnosis\RecommendedTroubleshootingScanner', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticResolver', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\WindowsUpdate\Refresh Group Policy Cache', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\Schedule Scan', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\Schedule Scan Static Task', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\Schedule Wake To Work', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\Start Oobe Expedite Work', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\WlanSvc\CDSSync', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\Report Policies', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\UUS Failover Task', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\StartOobeAppsScanAfterUpdate', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\StartOobeAppsScan_LicenseAccepted', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Application Experience\MareBackup', operation: delete}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\USO_UxBroker', operation: delete}
  - !scheduledTask: {path: '\Microsoft\Windows\Customer Experience Improvement Program\UsbCeip', operation: delete}
  - !scheduledTask: {path: '\Microsoft\Windows\Customer Experience Improvement Program\Consolidator', operation: delete}
  - !scheduledTask: {path: '\MicrosoftEdgeUpdateTaskMachineCore', operation: delete}
  - !scheduledTask: {path: '\MicrosoftEdgeUpdateTaskMachineUA', operation: delete}

#disableservicehostsplit
  - !registryValue: {path: 'HKLM\SYSTEM\ControlSet001\Control', value: 'SvcHostSplitThresholdInKB', type:  REG_DWORD, data: '4294967295'}

#disablesleepstudy
  - !run:
    exe: 'wevtutil.exe'
    args: 'set-log "Microsoft-Windows-SleepStudy/Diagnostic" /e:false'
  - !run:
    exe: 'wevtutil.exe'
    args: 'set-log "Microsoft-Windows-Kernel-Processor-Power/Diagnostic" /e:false'
  - !run:
    exe: 'wevtutil.exe'
    args: 'set-log "Microsoft-Windows-UserModePowerService/Diagnostic" /e:false'
  - !scheduledTask: {path: '\Microsoft\Windows\Power Efficiency Diagnostics\AnalyzeSystem', operation: disable}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power', value: 'SleepStudyDisabled', type: REG_DWORD, data: '1'}

#disablestorportidle
  - !cmd:
    command: 'for /f "tokens=*" %s in (''reg query "HKLM\SYSTEM\CurrentControlSet\Enum" /s /f "StorPort" ^| findstr /e "StorPort" '') do Reg.exe add "%s" /v "EnableIdlePowerManagement" /t REG_DWORD /d "0" /f'
    exeDir: true
    wait: true
    runas: currentUserElevated

#gamedvr
  - !registryValue: {path: 'HKCU\System\GameConfigStore', value: 'GameDVR_DSEBehavior', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\System\GameConfigStore', value: 'GameDVR_DXGIHonorFSEWindowsCompatible', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\System\GameConfigStore', value: 'GameDVR_EFSEFeatureFlags', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\System\GameConfigStore', value: 'GameDVR_FSEBehaviorMode', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\System\GameConfigStore', value: 'GameDVR_HonorUserFSEBehaviorMode', type: REG_DWORD, data: '1'}

#enablewritecache
  - !cmd:
    command: 'for /f "delims=" %k in (''Reg.exe Query hklm\SYSTEM\CurrentControlSet\Enum /f "{4d36e967-e325-11ce-bfc1-08002be10318}" /d /s ^| Find "HKEY" '') do Reg.exe add "%k\Device Parameters\Disk" /v UserWriteCacheSetting /t reg_dword /d 1 /f & Reg.exe add "%k\Device Parameters\Disk" /v CacheIsPowerProtected /t reg_dword /d 1 /f'
    exeDir: true
    wait: true
    runas: currentUserElevated

#ntfs
  - !run: {exe: 'fsutil', args: 'behavior set disablelastaccess 1'}
  - !run: {exe: 'fsutil', args: 'behavior set disable8dot3 1'}
  - !run: {exe: 'fsutil', args: 'behavior set disabledeletenotify 0'}
  - !run: {exe: 'fsutil', args: 'behavior set encryptpagingfile 0'}
  - !run: {exe: 'fsutil', args: 'behavior set disablecompression 1'}
  - !run: {exe: 'fsutil', args: 'behavior set enablenonpagedntfs 1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\FileSystem', value: 'NtfsDisableVolsnapHints', type: REG_DWORD, data: '1'}

#gpusettings
    #enable optimizations for windowed games
  - !registryValue: {path: 'HKEY_CURRENT_USER\Software\Microsoft\DirectX\UserGpuPreferences', value: 'DirectXUserGlobalSettings', type:  REG_SZ, data: 'SwapEffectUpgradeEnable=1;'}
    #disable Hags
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\GraphicsDrivers', value: 'HwSchMode', type:  REG_DWORD, data: '1'}

#apppermisions
    # === Location - Off
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location', value: 'Value', type: REG_SZ, data: 'Deny'}
    # === Camera - On
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam', value: 'Value', type: REG_SZ, data: 'Allow'}
    # === Microphone - On
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone', value: 'Value', type: REG_SZ, data: 'Allow'}
    # === Notifications - Off
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userNotificationListener', value: 'Value', type: REG_SZ, data: 'Deny'}
    # === Motion - Off
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\activity', value: 'Value', type: REG_SZ, data: 'Deny'}
    # === Account info - Off
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userAccountInformation', value: 'Value', type: REG_SZ, data: 'Deny'}
    # === Tasks - Off
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userDataTasks', value: 'Value', type: REG_SZ, data: 'Deny'}
    # === Messaging - Off
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\chat', value: 'Value', type: REG_SZ, data: 'Deny'}
    # === Radios - Off
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\radios', value: 'Value', type: REG_SZ, data: 'Deny'}
    # === Other devices - Off
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\bluetoothSync', value: 'Value', type: REG_SZ, data: 'Deny'}
    # === Background apps - Off
  - !registryValue: {path: 'HKLM\Software\Microsoft\Windows\CurrentVersion\Search', value: 'BackgroundAppGlobalToggle', type: REG_DWORD, data: '0'}
    # === App diagnostics - Off
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appDiagnostics', value: 'Value', type: REG_SZ, data: 'Deny'}
    # === File system - Off
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\broadFileSystemAccess', value: 'Value', type: REG_SZ, data: 'Deny'}

  #disablesettingsync
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableSettingSync', type: REG_DWORD, data: '2'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableSettingSyncUserOverride', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableSyncOnPaidNetwork', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableWindowsSettingSync', type: REG_DWORD, data: '2'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Personalization', value: 'Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\BrowserSettings', value: 'Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Credentials', value: 'Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Accessibility', value: 'Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Windows', value: 'Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync', value: 'SyncPolicy', type: REG_DWORD, data: '5'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableApplicationSettingSync', type: REG_DWORD, data: '2'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableApplicationSettingSyncUserOverride', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableWebBrowserSettingSync', type: REG_DWORD, data: '2'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableWebBrowserSettingSyncUserOverride', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableDesktopThemeSettingSync', type: REG_DWORD, data: '2'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableDesktopThemeSettingSyncUserOverride', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableCredentialsSettingSync', type: REG_DWORD, data: '2'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableCredentialsSettingSyncUserOverride', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisablePersonalizationSettingSync', type: REG_DWORD, data: '2'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisablePersonalizationSettingSyncUserOverride', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableStartLayoutSettingSync', type: REG_DWORD, data: '2'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync', value: 'DisableStartLayoutSettingSyncUserOverride', type: REG_DWORD, data: '1'}

  #configtime
  - !service: {name: 'w32time', operation: start, ignoreErrors: true}
  - !run: {exe: 'w32tm', args: '/config /syncfromflags:manual /manualpeerlist:"0.pool.ntp.org 1.pool.ntp.org 2.pool.ntp.org 3.pool.ntp.org"'}
  - !run: {exe: 'w32tm', args: '/config /update'}
  - !run: {exe: 'w32tm', args: '/resync'}

  #disablemouseaccel
  - !registryValue: {path: 'HKCU\Control Panel\Mouse', value: 'MouseSpeed', type: REG_SZ, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Mouse', value: 'MouseThreshold1', type: REG_SZ, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Mouse', value: 'MouseThreshold2', type: REG_SZ, data: '0'}

  #mousethrottle //cred eskezje
  - !registryValue: {path: 'HKCU\Control Panel\Mouse', value: 'RawMouseThrottleEnabled', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Control Panel\Mouse', value: 'RawMouseThrottleForced', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Control Panel\Mouse', value: 'RawMouseThrottleDuration', type: REG_DWORD, data: '20'}
  - !registryValue: {path: 'HKCU\Control Panel\Mouse', value: 'RawMouseThrottleLeeway', type: REG_DWORD, data: '0'}

  #disable telemetry / improve privacy
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Messaging', value: 'AllowMessageSync', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System', value: 'NoConnectedUser', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Device Metadata', value: 'PreventDeviceMetadataFromNetwork', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Control Panel\International\User Profile', value: 'HttpAcceptLanguageOptOut', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters', value: 'RestrictNullSessAccess', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Lsa', value: 'RestrictAnonymous', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\CDP\SettingsPage', value: 'BluetoothLastDisabledNearShare', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\CDP', value: 'NearShareChannelUserAuthzPolicy', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\CDP', value: 'CdpSessionUserAuthzPolicy', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\AppV\CEIP', value: 'CEIPEnable', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\SQMClient\Windows', value: 'CEIPEnable', type: REG_DWORD, data: '0'}
  - !run: {exe: 'taskkill', args: '/im CompatTelRunner.exe /f '}
  - !file: {path: '%windir%\system32\CompatTelRunner.exe'}
  - !run: {exe: 'taskkill', args: '/im AggregatorHost.exe /f '}
  - !file: {path: '%windir%\system32\AggregatorHost.exe'}
  - !scheduledTask: {path: '\Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser Exp', operation: disable}
  - !scheduledTask: {path: '\Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser', operation: disable}
  - !powerShell:
    command: >-
      Get-ScheduledTask | Where-Object { $_.TaskName -like '*Microsoft Compatibility Appraiser Exp*' } | ForEach-Object { Unregister-ScheduledTask -TaskName $_.TaskName -Confirm:$false }
    runas: currentUserElevated
    wait: true
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Personalization', value: 'NoLockScreenCamera', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'NoResolveTrack', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\WMDRM', value: 'DisableOnline', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Speech_OneCore\Settings\OnlineSpeechPrivacy', value: 'HasAccepted', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat', value: 'AITEnable', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat', value: 'AllowTelemetry', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat', value: 'DisableEngine', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat', value: 'DisableInventory', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat', value: 'DisablePCA', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat', value: 'DisableUAR', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\AppCompat', value: 'DisablePCA', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d}', value: 'ScenarioExecutionEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\Windows\WindowsCopilot', value: 'TurnOffWindowsCopilot', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Software\Policies\Microsoft\Windows\WindowsCopilot', value: 'TurnOffWindowsCopilot', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Siuf\Rules', value: 'NumberOfSIUFInPeriod', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Siuf\Rules', value: 'PeriodInNanoSeconds', operation: delete}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection', value: 'DoNotShowFeedbackNotifications', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent', value: 'DisableWindowsSpotlightFeatures', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent', value: 'DisableWindowsSpotlightWindowsWelcomeExperience', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent', value: 'DisableWindowsSpotlightOnActionCenter', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent', value: 'DisableWindowsSpotlightOnSettings', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent', value: 'DisableThirdPartySuggestions', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy', value: 'TailoredExperiencesWithDiagnosticDataEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent', value: 'DisableTailoredExperiencesWithDiagnosticData', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\PCHealth\ErrorReporting', value: 'DoReport', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting', value: 'Disabled', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceInstall\Settings', value: 'DisableSendGenericDriverNotFoundToWER', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceInstall\Settings', value: 'DisableSendRequestAdditionalSoftwareToWER', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\PCHealth\ErrorReporting', value: 'DoReport', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\PCHealth\ErrorReporting', value: 'ShowUI', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Error Report', value: 'AutoApproveOSDumps', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting\Consent', value: 'value', type: REG_SZ, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting', value: 'DontSendAdditionalData', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting', value: 'LoggingDisabled', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection', value: 'LimitEnhancedDiagnosticDataWindowsAnalytics', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection', value: 'LimitDumpCollection', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection', value: 'LimitDiagnosticLogCollection', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Diagnostics\DiagTrack', value: 'ShowedToastAtLevel', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection', value: 'AllowTelemetry', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection', value: 'AllowTelemetry', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection', value: 'DoNotShowFeedbackNotifications', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent', value: 'DisableTailoredExperiencesWithDiagnosticData', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\PolicyManager\default\System\AllowTelemetry', value: 'value', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search', value: 'ConnectedSearchPrivacy', type: REG_DWORD, data: '3'}
  - !registryKey: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Diagtrack-Listener'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Diagtrack-Listener', value: 'Start', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Diagnostics\DiagTrack\EventTranscriptKey', value: 'EnableEventTranscript', type: REG_DWORD, data: '0'}
  - !cmd: {command: 'del "%ProgramData%\Microsoft\Diagnosis\ETLLogs\AutoLogger\DiagTrack*" "%ProgramData%\Microsoft\Diagnosis\ETLLogs\ShutdownLogger\DiagTrack*"'}
  - !cmd: {command: 'setx DOTNET_CLI_TELEMETRY_OPTOUT 1'}
  - !cmd: {command: 'setx DOTNET_TRY_CLI_TELEMETRY_OPTOUT 1'}
  - !cmd: {command: 'setx CLOUDSDK_CORE_DISABLE_PROMPTS 1'}
  - !cmd: {command: 'setx DOCKER_CLI_TELEMETRY_OPTOUT 1'}
  - !cmd: {command: 'setx npm_config_loglevel silent'}
  - !cmd: {command: 'setx VS_TELEMETRY_OPT_OUT 1 '}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'NoInstrumentation', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services', value: 'LoggingEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsAI', value: 'DisableAIDataAnalysis', type: REG_DWORD, data: '1', builds: ['>=26100']}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System', value: 'RSoPLogging', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Accessibility\SlateLaunch', value: 'LaunchAT', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System', value: 'UploadUserActivities', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System', value: 'PublishUserActivities', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors', value: 'DisableSensors', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors', value: 'DisableWindowsLocationProvider', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors', value: 'DisableLocationScripting', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors', value: 'DisableLocation', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\FindMyDevice', value: 'AllowFindMyDevice', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\FindMyDevice', value: 'LocationSyncEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Lsa', value: 'RestrictAnonymousSAM', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System', value: 'EnableCdp', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Session Manager', value: 'DisableWpbtExecution', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform', value: 'NoGenTicket', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System', value: 'EnableActivityFeed', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System', value: 'PublishUserActivities', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System', value: 'UploadUserActivities', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo', value: 'Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\Windows\AdvertisingInfo', value: 'DisabledByGroupPolicy', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\Windows\AdvertisingInfo', value: 'DisableGraphRecentItems', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo', value: 'Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'Start_TrackProgs', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\EdgeUI', value: 'DisableMFUTracking', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Software\Policies\Microsoft\Windows\EdgeUI', value: 'TurnOffBackstack', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\InputPersonalization', value: 'RestrictImplicitTextCollection', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\InputPersonalization', value: 'RestrictImplicitInkCollection', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\CPSS\Store\InkingAndTypingPersonalization', value: 'Value', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\Software\Microsoft\Personalization\Settings', value: 'AcceptedPrivacyPolicy', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Personalization\Settings', value: 'AcceptedPrivacyPolicy', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\InputPersonalization\TrainedDataStore', value: 'HarvestContacts', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'ContentDeliveryAllowed', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'FeatureManagementEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'SubscribedContentEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'OemPreInstalledAppsEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'PreInstalledAppsEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'PreInstalledAppsEverEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'SilentInstalledAppsEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\SystemSettings\AccountNotifications', value: 'EnableAccountNotifications', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'SubscribedContent-310093Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'SubscribedContent-338393Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'SubscribedContent-353694Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'SubscribedContent-353696Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'SystemPaneSuggestionsEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'SubscribedContent-338387Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'RotatingLockScreenOverlayEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'SubscribedContent-338388Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'SubscribedContent-338389Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager', value: 'SoftLandingEnabled', type: REG_DWORD, data: '0'}

  #searchsettings / startmenu
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search', value: 'BingSearchEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings', value: 'IsAADCloudSearchEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings', value: 'IsDeviceSearchHistoryEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings', value: 'IsMSACloudSearchEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings', value: 'SafeSearchMode', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search', value: 'ConnectedSearchUseWeb', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search', value: 'DisableWebSearch', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search', value: 'EnableDynamicContentInWSB', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer', value: 'DisableSearchBoxSuggestions', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search', value: 'SearchboxTaskbarMode', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\SearchSettings', value: 'IsDynamicSearchBoxEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'NoStartMenuMFUprogramsList', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer', value: 'ShowOrHideMostUsedApps', type: REG_DWORD, data: '2'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer', value: 'HideRecentlyAddedApps', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer', value: 'HideRecommendedPersonalizedSites', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System', value: 'HideFastUserSwitching', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'Start_IrisRecommendations', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'Start_AccountNotifications', type: REG_DWORD, data: '0'}

  #visual / qol
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\DelegateFolders\{F5FB2C77-0E2F-4A16-A381-3E560C68BC83}'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications', value: 'GlobalUserDisabled', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search', value: 'BackgroundAppGlobalToggle', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters', value: 'DisableBandwidthThrottling', type:  REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy', value: '04', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy', value: '01', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Classes\SOFTWARE\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy', value: '01', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Appx', value: 'AllowAutomaticAppArchiving', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System', value: 'DisableAutomaticRestartSignOn', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Dfrg\BootOptimizeFunction', value: 'Enable', type: REG_SZ, data: 'N'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OptimalLayout', value: 'EnableAutoLayout', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\UserProfileEngagement', value: 'ScoobeSystemSettingEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Search\Preferences', value: 'WholeFileSystem', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\CrashControl', value: 'AutoReboot', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\CrashControl', value: 'CrashDumpEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\CrashControl', value: 'LogEvent', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\CrashControl', value: 'DisplayParameters', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry', value: 'DeviceDumpEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Desktop', value: 'HungAppTimeout', type: REG_SZ, data: '2000'}
  - !registryValue: {path: 'HKCU\Control Panel\Desktop', value: 'WaitToKillAppTimeOut', type: REG_SZ, data: '2000'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control', value: 'WaitToKillServiceTimeout', type: REG_SZ, data: '2000'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Ease of Access', value: 'selfscan', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Ease of Access', value: 'selfvoice', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Accessibility\HighContrast', value: 'Flags', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Accessibility\Keyboard Response', value: 'Flags', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Accessibility\MouseKeys', value: 'Flags', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Accessibility\StickyKeys', value: 'Flags', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Accessibility\ToggleKeys', value: 'Flags', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Accessibility\TimeOut', value: 'Flags', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Accessibility\SoundSentry', value: 'Flags', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Keyboard', value: 'KeyboardDelay', type: REG_SZ, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Accesibility\SoundSentry', value: 'WindowsEffect', type: REG_SZ, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Accesibility', value: 'Warning Sounds', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Accesibility', value: 'Sound on Activation', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Accessibility\MouseKeys', value: 'MaximumSpeed', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCU\Control Panel\Accesibility\MouseKeys', value: 'TimeToMaximumSpeed', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\TabletTip\1.7', value: 'DisablePrediction', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace', value: 'AllowSuggestedAppsInWindowsInkWorkspace', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server', value: 'fDenyTSConnections', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp', value: 'SecurityLayer', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp', value: 'UserAuthentication', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\FileHistory', value: 'Disabled', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\Maintenance', value: 'MaintenanceDisabled', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\ScheduledDiagnostics', value: 'EnabledExecution', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Task Scheduler\Maintenance', value: 'WakeUp', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\ScheduledDiagnostics', value: 'EnabledExecution', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System', value: 'verbosestatus', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Control Panel\Desktop', value: 'AutoEndTasks', type: REG_SZ, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Multimedia\Audio\DeviceCpl', value: 'ShowDisconnectedDevices', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Multimedia\Audio\DeviceCpl', value: 'ShowHiddenDevices', type: REG_DWORD, data: '0'}
  # - !file: {path: '%windir%\SystemResources\Windows.UI.TaskManager'}
  - !registryValue: {path: 'HKCU\Software\Classes\CLSID\{2aa9162e-c906-4dd9-ad0b-3d24a8eef5a0}', value: '', type: REG_SZ, data: 'CLSID_ItemsViewAdapter'}
  - !registryValue: {path: 'HKCU\Software\Classes\CLSID\{2aa9162e-c906-4dd9-ad0b-3d24a8eef5a0}\InProcServer32', value: '', type: REG_SZ, data: 'C:\Windows\System32\Windows.UI.FileExplorer.dll_'}
  - !registryValue: {path: 'HKCU\Software\Classes\CLSID\{2aa9162e-c906-4dd9-ad0b-3d24a8eef5a0}\InProcServer32', value: 'ThreadingModel', type: REG_SZ, data: 'Apartment'}
  - !registryValue: {path: 'HKCU\Software\Classes\CLSID\{6480100b-5a83-4d1e-9f69-8ae5a88e9a33}', value: '', type: REG_SZ, data: 'File Explorer Xaml Island View Adapter'}
  - !registryValue: {path: 'HKCU\Software\Classes\CLSID\{6480100b-5a83-4d1e-9f69-8ae5a88e9a33}\InProcServer32', value: '', type: REG_SZ, data: 'C:\Windows\System32\Windows.UI.FileExplorer.dll_'}
  - !registryValue: {path: 'HKCU\Software\Classes\CLSID\{6480100b-5a83-4d1e-9f69-8ae5a88e9a33}\InProcServer32', value: 'ThreadingModel', type: REG_SZ, data: 'Apartment'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'MultiTaskingAltTabFilter', type: REG_DWORD, data: '3'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'NoAutorun', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers', value: 'DisableAutoplay', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'NoDriveTypeAutoRun', type: REG_DWORD, data: '255'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer', value: 'NoAutoplayfornonVolume', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'DisallowShaking', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'NoLowDiskSpaceChecks', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Control Panel\Desktop', value: 'MenuShowDelay', type: REG_SZ, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent', value: 'DisableCloudOptimizedContent', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent', value: 'DisableConsumerAccountStateContent', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent', value: 'DisableWindowsConsumerFeatures', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32', value: '', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'DontUsePowerShellOnWinX', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\WindowsMitigation', value: 'UserPreference', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer', value: 'DisableGraphRecentItems', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'DisablePreviewDesktop', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds', value: 'EnableFeeds', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Dsh', value: 'AllowNewsAndInterests', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'SharingWizardOn', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ImmersiveShell', value: 'SignInMode', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Chat', value: 'ChatIcon', type: REG_DWORD, data: '3'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'TaskbarMn', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings', value: 'TaskbarEndTask', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'HideSCAMeetNow', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MultiTaskingView\AllUpView', value: 'Enabled', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'ShowTaskViewButton', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'TaskbarAl', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Taskband', value: 'Favorites', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\OperationStatusManager', value: 'EnthusiastMode', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\Bags\AllFolders\Shell', value: 'FolderType', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'AutoCheckSelect', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{31C0DD25-9439-4F12-BF41-7FF4EDA38722}\PropertyBag', value: 'ThisPCPolicy', type: REG_SZ, data: 'Hide'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{a0c69a99-21c8-4671-8703-7934162fcf1d}\PropertyBag', value: 'ThisPCPolicy', type: REG_SZ, data: 'Hide'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{7d83ee9b-2244-4e70-b1f5-5393042af1e4}\PropertyBag', value: 'ThisPCPolicy', type: REG_SZ, data: 'Hide'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{0ddd015d-b06c-45d5-8c4c-f59713854639}\PropertyBag', value: 'ThisPCPolicy', type: REG_SZ, data: 'Hide'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{35286a68-3c57-41a1-bbb1-0eae73d76c95}\PropertyBag', value: 'ThisPCPolicy', type: REG_SZ, data: 'Hide'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{f42ee2d3-909f-4907-8871-4c22fc0bf756}\PropertyBag', value: 'ThisPCPolicy', type: REG_SZ, data: 'Hide'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{B4BFCC3A-DB2C-424C-B029-7FE99A87C641}\PropertyBag', value: 'ThisPCPolicy', type: REG_SZ, data: 'Hide'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\CLSID\{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}', value: 'System.IsPinnedToNameSpaceTree', type: REG_DWORD, data: '0'}
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}', operation: delete}
  # - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{f874310e-b6b7-47dc-bc84-b9e6b38f5903}'}
  # - !registryValue: {path: 'HKCU\Software\Classes\CLSID\{f874310e-b6b7-47dc-bc84-b9e6b38f5903}', value: 'System.IsPinnedToNameSpaceTree', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'NoResolveSearch', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'NoResolveTrack', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Classes\CLSID\{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}', value: 'System.IsPinnedToNameSpaceTree', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\CLSID\{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}', value: 'System.IsPinnedToNameSpaceTree', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\CabinetState', value: 'FullPath', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer', value: 'ShowCloudFilesInQuickAccess', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer', value: 'Max Cached Icons', type: REG_SZ, data: '4096'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer', value: 'Max Cached Icons', type: REG_SZ, data: '4096'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer', value: 'MultipleInvokePromptMinimum', type: REG_DWORD, data: '100'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer', value: 'ShowFrequent', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer', value: 'ShowRecent', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'Start_TrackDocs', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'ClearRecentDocsOnExit', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'NoRecentDocsHistory', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer', value: 'NoRemoteDestinations', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Control Panel\Desktop', value: 'MouseHoverTime', type: REG_SZ, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'NoInternetOpenWith', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'LaunchTo', type: REG_DWORD, data: '1'}
  - !registryKey: {path: 'HKCR\AllFilesystemObjects\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\CLSID\{450D8FBA-AD25-11D0-98A8-0800361B1103}\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\Directory\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\Drive\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\AllFilesystemObjects\shellex\ContextMenuHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\CLSID\{450D8FBA-AD25-11D0-98A8-0800361B1103}\shellex\ContextMenuHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\Directory\shellex\ContextMenuHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\Drive\shellex\ContextMenuHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer', value: 'NoPreviousVersionsPage', operation: delete}
  - !registryValue: {path: 'HKCU\SOFTWARE\Policies\Microsoft\PreviousVersions', value: 'DisableLocalPage', operation: delete}
  - !registryValue: {path: 'HKCR\DesktopBackground\Shell\Idle', value: 'Icon', type: REG_SZ, data: 'powercpl.dll'}
  - !registryValue: {path: 'HKCR\DesktopBackground\Shell\Idle', value: 'MUIVerb', type: REG_SZ, data: 'Idle'}
  - !registryValue: {path: 'HKCR\DesktopBackground\Shell\Idle', value: 'Position', type: REG_SZ, data: 'Bottom'}
  - !registryValue: {path: 'HKCR\DesktopBackground\Shell\Idle', value: 'SubCommands', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCR\DesktopBackground\Shell\Idle\Shell\Idle001', value: 'HasLUAShield', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCR\DesktopBackground\Shell\Idle\Shell\Idle001', value: 'MUIVerb', type: REG_SZ, data: 'Enable Idle'}
  - !registryValue: {path: 'HKCR\DesktopBackground\Shell\Idle\Shell\Idle001\command', value: '', type: REG_SZ, data: 'C:\Windows\Modules\IdleON.bat'}
  - !registryValue: {path: 'HKCR\DesktopBackground\Shell\Idle\Shell\Idle002', value: 'HasLUAShield', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCR\DesktopBackground\Shell\Idle\Shell\Idle002', value: 'MUIVerb', type: REG_SZ, data: 'Disable Idle'}
  - !registryValue: {path: 'HKCR\DesktopBackground\Shell\Idle\Shell\Idle002\command', value: '', type: REG_SZ, data: 'C:\Windows\Modules\IdleOFF.bat'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.nip', value: 'FriendlyTypeName', type: REG_SZ, data: 'nvidiaProfileInspector Profile'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Classes\.nip', value: '', type: REG_SZ, data: 'nvidiaProfileInspector Profile'}
  - !registryValue: {path: 'HKCR\.nip\Shell', value: '', type: REG_SZ, data: 'Import'}
  - !registryValue: {path: 'HKCR\.nip\Shell\Import\Command', value: '', type: REG_EXPAND_SZ, data: '"C:\Windows\Modules\nvidiaprofileinspector.exe" "%1"'}
  - !registryValue: {path: 'HKCR\.nip\DefaultIcon', value: '', type: REG_EXPAND_SZ, data: 'c:\windows\modules\nvidiaprofileinspector.exe,0'}
  - !registryValue: {path: 'HKCR\.pow', value: '', type: REG_SZ, data: 'Power Plan'}
  - !registryValue: {path: 'HKCR\.pow', value: 'FriendlyTypeName', type: REG_SZ, data: 'Power Plan'}
  - !registryValue: {path: 'HKCR\.pow\DefaultIcon', value: '', type: REG_EXPAND_SZ, data: '%SystemRoot%\System32\powercfg.cpl,-202'}
  - !registryValue: {path: 'HKCR\.pow\shell\Import\command', value: '', type: REG_SZ, data: 'powercfg /import "%1"'}
  - !registryValue: {path: 'HKCR\CABFolder\Shell\RunAs', value: '', type: REG_SZ, data: 'Install'}
  - !registryValue: {path: 'HKCR\CABFolder\Shell\RunAs', value: 'HasLUAShield', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCR\CABFolder\Shell\RunAs\Command', value: '', type: REG_SZ, data: 'cmd /k dism /online /add-package /packagepath:"%1"'}
  - !registryValue: {path: 'HKCR\.reg\ShellNew', value: 'NullFile', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCR\.reg\ShellNew', value: 'ItemName', type: REG_EXPAND_SZ, data: '%windir%\regedit.exe,-309'}
  - !registryValue: {path: 'HKCR\.bat\ShellNew', value: 'ItemName', type: REG_EXPAND_SZ, data: '%windir%\System32\acppage.dll,-6002'}
  - !registryValue: {path: 'HKCR\.bat\ShellNew', value: 'NullFile', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCR\.ps1', value: '', type: REG_SZ, data: 'Microsoft.PowerShellScript.1'}
  - !registryValue: {path: 'HKCR\.ps1\ShellNew', value: 'NullFile', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCR\Microsoft.PowerShellScript.1', value: '', type: REG_SZ, data: 'Windows PowerShell Script'}
  - !registryValue: {path: 'HKCR\Microsoft.PowerShellScript.1', value: 'FriendlyTypeName', type: REG_SZ, data: 'Windows PowerShell Script'}
  - !registryValue: {path: 'HKCR\Directory\shell\runas', value: '', type: REG_SZ, data: 'Take Ownership'}
  - !registryValue: {path: 'HKCR\Directory\shell\runas', value: 'HasLUAShield', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCR\Directory\shell\runas', value: 'NoWorkingDirectory', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCR\Directory\shell\runas\command', value: '', type: REG_SZ, data: 'cmd.exe /c takeown /f %1 /r /d y && icacls %1 /grant administrators:F'}
  - !registryValue: {path: 'HKCR\Directory\shell\runas\command', value: 'IsolatedCommand', type: REG_SZ, data: 'cmd.exe /c takeown /f %1 /r /d y && icacls %1 /grant administrators:F'}
  - !cmd: {command: '"reg import runasti.reg', exeDir: true, wait: true, runas: currentUserElevated}
#Sendto
  # - !registryKey: {path: 'HKCR\AllFilesystemObjects\shellex\ContextMenuHandlers\SendTo'}
  # - !registryKey: {path: 'HKCR\UserLibraryFolder\shellex\ContextMenuHandlers\SendTo'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked', value: '{7AD84985-87B4-4a16-BE58-8B72A5B390F7}', type: REG_SZ, data: ''}
  - !registryKey: {path: 'HKCR\CompressedFolder\ShellEx\ContextMenuHandlers\{b8cdcb65-b1bf-4b42-9428-1dfdb7ee92af}'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\.zip\ShellEx\ContextMenuHandlers\{b8cdcb65-b1bf-4b42-9428-1dfdb7ee92af}'}
  - !registryKey: {path: 'HKCR\*\shellex\ContextMenuHandlers\Sharing'}
  - !registryKey: {path: 'HKCR\Directory\Background\shellex\ContextMenuHandlers\Sharing'}
  - !registryKey: {path: 'HKCR\Directory\shellex\ContextMenuHandlers\Sharing'}
  - !registryKey: {path: 'HKCR\Drive\shellex\ContextMenuHandlers\Sharing'}
  - !registryKey: {path: 'HKCR\LibraryFolder\background\shellex\ContextMenuHandlers\Sharing'}
  - !registryKey: {path: 'HKCR\UserLibraryFolder\shellex\ContextMenuHandlers\Sharing'}
  - !registryKey: {path: 'HKCR\Folder\ShellEx\ContextMenuHandlers\Library Location'}
  - !registryKey: {path: 'HKCR\.rtf\ShellNew'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\.3mf\Shell\3D Edit'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\.bmp\Shell\3D Edit'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\.fbx\Shell\3D Edit'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\.gif\Shell\3D Edit'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\.jfif\Shell\3D Edit'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\.jpe\Shell\3D Edit'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\.jpeg\Shell\3D Edit'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\.jpg\Shell\3D Edit'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\.png\Shell\3D Edit'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\.tif\Shell\3D Edit'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\.tiff\Shell\3D Edit'}
  - !registryKey: {path: 'HKEY_CLASSES_ROOT\*\shell\pintohomefile'}
  - !registryKey: {path: 'HKCR\Folder\shell\pintohome'}
  - !registryKey: {path: 'HKCR\Folder\shellex\ContextMenuHandlers\PintoStartScreen'}
  - !registryKey: {path: 'HKCR\exefile\shellex\ContextMenuHandlers\PintoStartScreen'}
  - !registryKey: {path: 'HKCR\Microsoft.Website\ShellEx\ContextMenuHandlers\PintoStartScreen'}
  - !registryKey: {path: 'HKCR\mscfile\shellex\ContextMenuHandlers\PintoStartScreen'}
  - !registryKey: {path: 'HKCR\AllFilesystemObjects\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\CLSID\{450D8FBA-AD25-11D0-98A8-0800361B1103}\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\Directory\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\Drive\shellex\PropertySheetHandlers\{596AB062-B4D2-4215-9F74-E9109B0A8153}'}
  - !registryKey: {path: 'HKCR\SystemFileAssociations\image\shell\print'}
  - !registryKey: {path: 'HKCR\batfile\shell\print'}
  - !registryKey: {path: 'HKCR\fonfile\shell\print'}
  - !registryKey: {path: 'HKCR\cmdfile\shell\print'}
  - !registryKey: {path: 'HKCR\htmlfile\shell\print'}
  - !registryKey: {path: 'HKCR\JSEFile\Shell\Print'}
  - !registryKey: {path: 'HKCR\otffile\shell\print'}
  - !registryKey: {path: 'HKCR\pfmfile\shell\print'}
  - !registryKey: {path: 'HKCR\regfile\shell\print'}
  - !registryKey: {path: 'HKCR\ttcfile\shell\print'}
  - !registryKey: {path: 'HKCR\ttffile\shell\print'}
  - !registryKey: {path: 'HKCR\VBEFile\Shell\Print'}
  - !registryKey: {path: 'HKCR\VBSFile\Shell\Print'}
  - !registryKey: {path: 'HKCR\WSFFile\Shell\Print'}
  - !registryKey: {path: 'HKCR\*\shellex\ContextMenuHandlers\ModernSharing'}
  - !registryKey: {path: 'HKCR\AllFilesystemObjects\shellex\ContextMenuHandlers\ModernSharing'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked', value: '{1d27f844-3a1f-4410-85ac-14651078412d}', type: REG_SZ, data: ''}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'UseCompactMode', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\Control Panel\Desktop', value: 'UserPreferencesMask', type: REG_BINARY, data: '9012038012000000'}
  - !registryValue: {path: 'HKCU\Control Panel\Desktop', value: 'DragFullWindows', type: REG_SZ, data: '1'}
  - !registryValue: {path: 'HKCU\Control Panel\Desktop\WindowMetrics', value: 'MinAnimate', type: REG_SZ, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'ListviewAlphaSelect', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'IconsOnly', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'TaskbarAnimations', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'ListviewShadow', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects', value: 'VisualFXSetting', type: REG_DWORD, data: '3'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\DWM', value: 'EnableAeroPeek', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\DWM', value: 'AlwaysHibernateThumbnails', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize', value: 'EnableTransparency', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Control Panel\Desktop', value: 'ForegroundLockTimeout', type: REG_DWORD, data: '0'}
#Setting
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'SettingsPageVisibility', type: REG_SZ, data: 'hide:home;windowsupdate;privacy-automaticfiledownloads;privacy-feedback;windowsinsider;deviceusage;maps;otherusers;findmydevice;windowsdefender;quiethours;powersleep;batterysaver;batterysaver-settings;storagesense;storagepolicies;savelocations;project;crossdevice;mobile-devices;network-dialup;videoplayback;privacy-speech;privacy-activityhistory;recovery;troubleshoot;privacy-general;pen'} 
#Setting
  - !taskKill: {name: 'explorer'}
  - !run: {exe: 'explorer.exe', runas: 'currentUser', wait: false}
  - !registryValue: {path: 'HKCU\Control Panel\Desktop', value: 'JPEGImportQuality', type: REG_DWORD, data: '100'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Icons', value: '29', type: REG_SZ, data: 'C:\Windows\system32\blank.ico'}
  - !registryValue: {path: 'HKCU\Control Panel\Colors', value: 'InfoWindow', type: REG_SZ, data: '246 253 255'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize', value: 'SystemUsesLightTheme', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize', value: 'AppsUseLightTheme', type: REG_DWORD, data: '0'}
  - !taskKill: {name: 'explorer'}
  - !cmd: {command: 'DEL /F /S /Q /A %LocalAppData%\Microsoft\Windows\Explorer\thumbcache_*.db', exeDir: true, wait: true}
  - !registryValue: {path: 'HKCU\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\Bags\AllFolders\Shell', value: 'Logo', type: REG_SZ, data: 'imageres.dll,-3'}
  - !run: {exe: 'explorer.exe', runas: 'currentUser', wait: false}
  - !registryValue: {path: 'HKCU\Control Panel\Desktop', value: 'WindowArrangementActive', type: REG_SZ, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\WindowsRuntime\ActivatableClassId\ValueBanner.IdealStateFeatureControlProvider', value: 'ActivationType', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCR\CLSID\{D15ED2E1-C75B-443c-BD7C-FC03B2F08C17}', data: 'All Tasks', type: REG_SZ}
  - !registryValue: {path: 'HKCR\CLSID\{D15ED2E1-C75B-443c-BD7C-FC03B2F08C17}', value: 'InfoTip', type: REG_SZ, data: 'View list of all Control Panel tasks'}
  - !registryValue: {path: 'HKCR\CLSID\{D15ED2E1-C75B-443c-BD7C-FC03B2F08C17}', value: 'System.ControlPanel.Category', type: REG_SZ, data: '5'}
  - !registryValue: {path: 'HKCR\CLSID\{D15ED2E1-C75B-443c-BD7C-FC03B2F08C17}\DefaultIcon', data: '%windir%\System32\imageres.dll,-27', type: REG_SZ}
  - !registryValue: {path: 'HKCR\CLSID\{D15ED2E1-C75B-443c-BD7C-FC03B2F08C17}\Shell\Open\Command', data: 'explorer.exe shell:::{ED7BA470-8E54-465E-825C-99712043E01C}', type: REG_SZ}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel\NameSpace\{D15ED2E1-C75B-443c-BD7C-FC03B2F08C17}', data: 'All Tasks', type: REG_SZ}
  - !registryValue: {path: 'HKCU\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\Bags\AllFolders\Shell', value: 'FolderType', type: REG_SZ, data: 'NotSpecified'}
  # - !powerShell: {command: '.\Sound-disabled.ps1', exeDir: true, wait: true, runas: currentUserElevated}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Multimedia\Audio', value: 'UserDuckingPreference', type: REG_DWORD, data: '3'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Kernel DMA Protection', value: 'DeviceEnumerationPolicy', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\BitLocker', value: 'PreventDeviceEncryption', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'Hidden', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced', value: 'HideFileExt', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\NamingTemplates', value: 'ShortcutNameTemplate', type: REG_SZ, data: '"%s.lnk"'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Serialize', value: 'StartupDelayInMSec', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System', value: 'DelayedDesktopSwitchTimeout', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\EditionOverrides', value: 'UserSetting_DisableStartupSound', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent', value: 'DisableSoftLanding', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\EdgeUI', value: 'DisableHelpSticker', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\System', value: 'AllowOnlineTips', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\PolicyManager\default\Settings\AllowOnlineTips', value: 'value', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer', value: 'AllowOnlineTips', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Shell\USB', value: 'NotifyOnUsbErrors', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\SOFTWARE\Microsoft\Shell\USB', value: 'NotifyOnWeakCharger', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Associations', value: 'LowRiskFileTypes', type: REG_SZ, data: '.avi;.bat;.cmd;.exe;.htm;.html;.lnk;.mpg;.mpeg;.mov;.mp3;.mp4;.mkv;.msi;.m3u;.rar;.reg;.txt;.vbs;.wav;.zip;.7z;.ps1'}
  - !registryValue: {path: 'HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Attachments', value: 'SaveZoneInformation', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3', value: '1806', type: REG_DWORD, data: '0'}

  #disableuselessdevices
  - !powerShell: {command: '.\DISABLEPNP.ps1', exeDir: true, wait: true}

  #deletedefaultuser0
  - !cmd: {command: 'net user defaultuser0 /delete & exit 0'}

  #disablemitigations
  - !cmd: {command: '"disablemitigations.bat"', exeDir: true, wait: true}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\DeviceGuard\Scenarios\KernelShadowStacks', value: 'Enabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\SCMConfig', value: 'EnableSvchostMitigationsPolicy', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\CurrentControlSet\Control\Lsa', value: 'RunAsPPL', type: REG_DWORD, data: '0'}

  #nic
  # - !cmd: {command: '"nic.bat"', exeDir: true, wait: true}

  #associations
  - !powerShell: {command: '.\SetFileTypeAssociation.ps1', exeDir: true, wait: true, runas: currentuser}

  #disabledmaremapping
  - !cmd: {command: 'for /f %i in (''reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services" /s /f "DmaRemappingCompatible" ^| find /i "Services\" '') do Reg.exe add "%i" /v "DmaRemappingCompatible" /t REG_DWORD /d "0" /f', exeDir: true, wait: true, runas: currentUserElevated}

  #disablewindowsupdate
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\AU', value: 'AUOptions', type: REG_DWORD, data: '2'}
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\DevHomeUpdate'}
  - !registryKey: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\OutlookUpdate'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate', value: 'TargetReleaseVersion', type: REG_DWORD, data: '1'}
  - !powerShell: {command: '$ver = (Get-ItemProperty ''HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion'').DisplayVersion; New-ItemProperty -Path ''HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate'' -Name ''TargetReleaseVersionInfo'' -Value $ver -PropertyType String -Force', wait: true}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate', value: 'DisableDualScan', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\DeliveryOptimization', value: 'DODownloadMode', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate', value: 'ExcludeWUDriversInQualityUpdate', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU', value: 'NoAutoUpdate', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate', value: 'DoNotConnectToWindowsUpdateInternetLocations', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate', value: 'SetDisableUXWUAccess', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching', value: 'SearchOrderConfig', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching', value: 'DontSearchWindowsUpdate', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Device Installer', value: 'DisableCoInstallers', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Maps', value: 'AutoDownloadAndUpdateMapData', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SYSTEM\Maps', value: 'AutoUpdateEnabled', type: REG_DWORD, data: '0'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsStore\WindowsUpdate', value: 'AutoDownload', type: REG_DWORD, data: '2'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\WindowsStore', value: 'AutoDownload', type: REG_DWORD, data: '2'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\WindowsStore', value: 'DisableOSUpgrade', type: REG_DWORD, data: '1'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Policies\Microsoft\Speech', value: 'AllowSpeechModelUpdate', type: REG_DWORD, data: '0'}

  #oem
  # - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OEMInformation', value: 'Manufacturer', type: REG_SZ, data: 'flash'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OEMInformation', value: 'Model', type: REG_SZ, data: 'Va1n'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OEMInformation', value: 'SupportURL', type: REG_SZ, data: 'https://dsc.gg/vainn'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion', value: 'EditionSubVersion', type: REG_SZ, data: 'Va1n'}
  - !registryValue: {path: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion', value: 'RegisteredOrganization', type: REG_SZ, data: 'Va1n'}

  #rebuildperfcounters
  - !run: {exe: 'lodctr', args: '/r'}
  - !run: {exe: 'lodctr', args: '/r'}
  - !run: {exe: 'winmgmt', args: '/resyncperf'}

  #disable print screen for snipping tool
  - !registryValue: {path: 'HKCU\Control Panel\Keyboard', value: 'PrintScreenKeyForSnippingEnabled', type: REG_DWORD, data: '0'}

  #zip / openshell
  # - !cmd: {command: '"configurezipopenshell.bat"', exeDir: true, wait: true, runas: currentUserElevated}

  - !writeStatus: {status: 'Creating services backup 2/2'}
  - !powerShell: {command: '.\BACKUP.ps1 -FilePath """$([Environment]::GetFolderPath(''Windows''))\ServicesBackup\vainServices.reg"""', wait: true, exeDir: true}

  - !writeStatus: {status: 'Cleaning up'}
  - !powerShell: {command: '.\CLEANUP.ps1', exeDir: true, wait: true}
